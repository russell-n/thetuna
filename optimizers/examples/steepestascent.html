<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Steepest Ascent Examples &mdash; The Tuna 2014.07.10 documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootswatch-3.3.4/spacelab/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2014.07.10',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/processing.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="The Tuna 2014.07.10 documentation" href="../../index.html" />
    <link rel="up" title="Optimizer Examples" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          The Tuna</a>
        <span class="navbar-text navbar-version pull-left"><b>2014.07.10</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/developer/index.html">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/user/index.html">User Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../log_setter.html">Log Setter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../main.html">The Main Entry Point</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../clients/index.html">Client Connections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../commands/index.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../components/index.html">The Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../explorations/index.html">Explorations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hosts/index.html">Hosts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../infrastructure/index.html">The Infrastructure</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parts/index.html">The Parts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plugins/index.html">The Tuna-Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../qualities/index.html">Quality Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tweaks/index.html">Tweaks</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Steepest Ascent Examples</a><ul>
<li><a class="reference internal" href="#a-normal-distribution-example">A Normal Distribution Example</a><ul>
</ul>
</li>
<li><a class="reference internal" href="#changing-the-parameters">Changing the Parameters</a></li>
<li><a class="reference internal" href="#needle-in-a-haystack">Needle In a Haystack</a></li>
<li><a class="reference internal" href="#using-gaussian-convolution">Using Gaussian Convolution</a></li>
<li><a class="reference internal" href="#gaussian-convolution-normal-example">Gaussian Convolution Normal Example</a></li>
<li><a class="reference internal" href="#gaussian-convolution-needle-example">Gaussian Convolution Needle Example</a></li>
<li><a class="reference internal" href="#gaussian-convolution-sphere">Gaussian Convolution Sphere</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../_sources/optimizers/examples/steepestascent.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="steepest-ascent-examples">
<h1>Steepest Ascent Examples<a class="headerlink" href="#steepest-ascent-examples" title="Permalink to this headline">¶</a></h1>
<p>These are examples for the <a class="reference internal" href="../steepestascent.html#optimization-optimizers-steepestascent"><span class="std std-ref">Hill-Climbing with Steepest Ascent</span></a> meta-heuristic.</p>
<p>Contents:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#optimization-optimizers-steepestascent-normalexample"><span class="std std-ref">Normal Distribution Example</span></a></li>
<li><a class="reference internal" href="#optimization-optimizers-steepestascent-needleinahaystack"><span class="std std-ref">Needle in a Haystack Example</span></a></li>
<li><a class="reference internal" href="#optimization-optimizers-steepestascent-gaussianconvolution"><span class="std std-ref">Gaussian Convolution Noisy Example</span></a></li>
<li><a class="reference internal" href="#optimization-optimizers-steepestascent-gaussianconvolution-normal"><span class="std std-ref">Gaussian Convolution Normal Example</span></a></li>
<li><a class="reference internal" href="#optimization-optimizers-steepestascent-gaussianconvolution-sphere"><span class="std std-ref">Gaussian Convolution Sphere Example</span></a></li>
</ul>
</div></blockquote>
<div class="section" id="a-normal-distribution-example">
<span id="optimization-optimizers-steepestascent-normalexample"></span><h2>A Normal Distribution Example<a class="headerlink" href="#a-normal-distribution-example" title="Permalink to this headline">¶</a></h2>
<p>The SteepestAscent climber with UniformConvolution is more aggresive than the hill-climber but still has a problem with local-optima so I&#8217;ll just test it on the normal-data here.</p>
<p class="plantuml">
<img src="../../_images/plantuml-7585991114d917c31a7de6a83255fae20db1d4c8.png" alt="HillClimber o- XYSolution
HillClimber o- XYTweak
HillClimber o- UniformConvolution
HillClimber o- StopConditionIdeal
HillClimber o- NormalSimulation" />
</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">SteepestAscent</span></code></td>
<td></td>
</tr>
</tbody>
</table>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">NormalSimulation</span></code></td>
<td></td>
</tr>
</tbody>
</table>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">StopConditionIdeal</span></code></td>
<td></td>
</tr>
</tbody>
</table>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">UniformConvolution</span></code></td>
<td></td>
</tr>
</tbody>
</table>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">XYSolution</span></code></td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">XYTweak</span></code></td>
<td></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># python standard library</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>

<span class="c1"># third party</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="c1"># this package</span>
<span class="kn">from</span> <span class="nn">optimization.datamappings.normalsimulation</span> <span class="k">import</span> <span class="n">NormalSimulation</span>
<span class="kn">from</span> <span class="nn">optimization.components.stopcondition</span> <span class="k">import</span> <span class="n">StopConditionIdeal</span>
<span class="kn">from</span> <span class="nn">optimization.components.convolutions</span> <span class="k">import</span> <span class="n">UniformConvolution</span><span class="p">,</span> <span class="n">Gaussi</span>
<span class="n">anConvolution</span>
<span class="kn">from</span> <span class="nn">optimization.components.xysolution</span> <span class="k">import</span> <span class="n">XYSolution</span><span class="p">,</span> <span class="n">XYTweak</span>
<span class="kn">from</span> <span class="nn">optimization.optimizers.steepestascent</span> <span class="k">import</span> <span class="n">SteepestAscent</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">outcomes</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">NormalSimulation</span><span class="p">(</span><span class="n">domain_start</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span>
                             <span class="n">domain_end</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                             <span class="n">steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="n">stop</span> <span class="o">=</span> <span class="n">StopConditionIdeal</span><span class="p">(</span><span class="n">ideal_value</span><span class="o">=</span><span class="n">simulator</span><span class="o">.</span><span class="n">ideal_solution</span><span class="p">,</span>
                              <span class="n">delta</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span>
                              <span class="n">time_limit</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

<span class="n">tweak</span> <span class="o">=</span> <span class="n">UniformConvolution</span><span class="p">(</span><span class="n">half_range</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                           <span class="n">lower_bound</span><span class="o">=</span><span class="n">simulator</span><span class="o">.</span><span class="n">domain_start</span><span class="p">,</span>
                           <span class="n">upper_bound</span><span class="o">=</span><span class="n">simulator</span><span class="o">.</span><span class="n">domain_end</span><span class="p">)</span>

<span class="n">xytweak</span> <span class="o">=</span> <span class="n">XYTweak</span><span class="p">(</span><span class="n">tweak</span><span class="p">)</span>
<span class="c1"># try a bad-case to start</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">simulator</span><span class="o">.</span><span class="n">domain_start</span><span class="p">])</span>
<span class="n">candidate</span> <span class="o">=</span> <span class="n">XYSolution</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">)</span>

<span class="n">climber</span> <span class="o">=</span> <span class="n">SteepestAscent</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">candidate</span><span class="p">,</span>
                         <span class="n">stop_condition</span><span class="o">=</span><span class="n">stop</span><span class="p">,</span>
                         <span class="n">tweak</span><span class="o">=</span><span class="n">xytweak</span><span class="p">,</span>
                         <span class="n">quality</span><span class="o">=</span><span class="n">simulator</span><span class="p">,</span>
                         <span class="n">local_searches</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">outcomes</span><span class="p">[</span><span class="s1">&#39;Uniform Normal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run_climber</span><span class="p">(</span><span class="n">climber</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Solution</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.01712284</span><span class="p">]</span> <span class="n">Output</span><span class="p">:</span> <span class="mf">0.398862340139</span>
<span class="n">Ideal</span><span class="p">:</span> <span class="mf">0.398939082483</span>
<span class="n">Difference</span><span class="p">:</span> <span class="o">-</span><span class="mf">7.67423442817e-05</span>
<span class="n">Elapsed</span><span class="p">:</span> <span class="mf">0.008633852005</span>
<span class="n">Quality</span> <span class="n">Checks</span><span class="p">:</span> <span class="mi">601</span>
<span class="n">Comparisons</span><span class="p">:</span> <span class="mf">300.0</span>
<span class="n">Solutions</span><span class="p">:</span> <span class="mi">58</span>
<span class="n">Solutions</span><span class="o">/</span><span class="n">Comparisons</span><span class="p">:</span> <span class="mf">0.193333333333</span>
</pre></div>
</div>
<p>The number of quality checks is related to the number of comparisons made between candidate solutions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">Quality</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Quality</span><span class="p">(</span><span class="n">candidate</span><span class="p">):</span>
    <span class="n">solution</span> <span class="o">=</span> <span class="n">candidate</span>
</pre></div>
</div>
<p>Each comparison uses two checks and there is an initializing check before the optimization starts (to establish the first candidate as the best solution found so far). So the total number of comparisons is:</p>
<div class="math">
<p><img src="../../_images/math/912c9751d5e441969834083b2e31c0b89d31f259.png" alt="Comparisons &amp;\gets \frac{QualityChecks - 1}{2}\\"/></p>
</div><div class="figure">
<img src="../../_images/normal_steepest_ascent.svg" /></div>
<p>The x-axis in the figure shows the number of times a better solution was found and the y-axis is the value (quality) of the solution. In this case the solution is a point on the x-axis and the quality is the height of the curve for the solution.</p>
<div class="figure">
<img src="../../_images/steepest_ascent_normal_data.svg" /></div>
<p>The blue-line in the figure is a plot of the data-set while the red line is the solution found by the hill-climber.</p>
</div>
<div class="section" id="changing-the-parameters">
<h2>Changing the Parameters<a class="headerlink" href="#changing-the-parameters" title="Permalink to this headline">¶</a></h2>
<p>The two main parameters that will affect the performance of the climber will be the number of local searches (<code class="docutils literal"><span class="pre">SteepestAscent.local_searches</span></code>) it does and the size of the random changes it makes (<code class="docutils literal"><span class="pre">UniformConvolution.half_range</span></code>). In this case we know that the input-data is actually one-dimensional and the distribution is unimodal so it might help to reduce the number of local searches and increase the half-range to see if it will climb faster.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">candidate</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">climber</span><span class="o">.</span><span class="n">_solutions</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">climber</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="n">candidate</span>
<span class="n">stop</span><span class="o">.</span><span class="n">_end_time</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">climber</span><span class="o">.</span><span class="n">local_searches</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">tweak</span><span class="o">.</span><span class="n">half_range</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">run_climber</span><span class="p">(</span><span class="n">climber</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Solution</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.01748886</span><span class="p">]</span> <span class="n">Output</span><span class="p">:</span> <span class="mf">0.398862340139</span>
<span class="n">Ideal</span><span class="p">:</span> <span class="mf">0.398939082483</span>
<span class="n">Difference</span><span class="p">:</span> <span class="o">-</span><span class="mf">7.67423442817e-05</span>
<span class="n">Elapsed</span><span class="p">:</span> <span class="mf">0.00139498710632</span>
<span class="n">Quality</span> <span class="n">Checks</span><span class="p">:</span> <span class="mi">692</span>
<span class="n">Comparisons</span><span class="p">:</span> <span class="mf">345.5</span>
<span class="n">Solutions</span><span class="p">:</span> <span class="mi">5</span>
<span class="n">Solutions</span><span class="o">/</span><span class="n">Comparisons</span><span class="p">:</span> <span class="mf">0.0144717800289</span>
</pre></div>
</div>
<p>I tried it with different numbers of local-search values and it actually seems to take longer if you go with either fewer or more of them. I guess if there are too few then you run a greater risk of moving in the wrong-direction and if there are too many you multiply the number of searches you make before checking the overall-best solution so it inevitably uses more comparisons. I guess the parameters have to be tuned according to the data with a certain amount of trial and error.</p>
</div>
<div class="section" id="needle-in-a-haystack">
<span id="optimization-optimizers-steepestascent-needleinahaystack"></span><h2>Needle In a Haystack<a class="headerlink" href="#needle-in-a-haystack" title="Permalink to this headline">¶</a></h2>
<p>Now a <a class="reference internal" href="../../qualities/normalsimulation.html#optimization-simulations-needle-in-haystack"><span class="std std-ref">Needle in a Haystack</span></a> case.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">simulator</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">domain_start</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">domain_end</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">candidate</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">climber</span><span class="o">.</span><span class="n">_solutions</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">climber</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="n">candidate</span>
<span class="n">climber</span><span class="o">.</span><span class="n">emit</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">stop</span><span class="o">.</span><span class="n">_end_time</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">stop</span><span class="o">.</span><span class="n">ideal_value</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">ideal_solution</span>
<span class="n">stop</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="mf">0.001</span>

<span class="n">outcomes</span><span class="p">[</span><span class="s1">&#39;Uniform Needle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run_climber</span><span class="p">(</span><span class="n">climber</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Solution</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">:</span> <span class="p">[</span> <span class="mf">0.03634837</span><span class="p">]</span> <span class="n">Output</span><span class="p">:</span> <span class="mf">0.398697954224</span>
<span class="n">Ideal</span><span class="p">:</span> <span class="mf">0.398922329796</span>
<span class="n">Difference</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.000224375571834</span>
<span class="n">Elapsed</span><span class="p">:</span> <span class="mf">0.00327515602112</span>
<span class="n">Quality</span> <span class="n">Checks</span><span class="p">:</span> <span class="mi">127</span>
<span class="n">Comparisons</span><span class="p">:</span> <span class="mf">63.0</span>
<span class="n">Solutions</span><span class="p">:</span> <span class="mi">7</span>
<span class="n">Solutions</span><span class="o">/</span><span class="n">Comparisons</span><span class="p">:</span> <span class="mf">0.111111111111</span>
</pre></div>
</div>
<div class="figure">
<img src="../../_images/needle_haystack_steepest_ascent.svg" /></div>
<div class="figure">
<img src="../../_images/steepest_ascent_uniform_needle_haystack_data.svg" /></div>
<p>Since the solutions are randomly generated, the figures don&#8217;t look exactly the same every time, but usually the solutions-plot for the <em>needle in a haystack</em> case will show a large dip in it as the hill-climber accidentally overshoots the peak. Since we&#8217;re using <em>Steepest Ascent Hill Climbing</em> it can usually find its way back, as long as the curve has information for it and the amount of randomization is small-enough that it will eventually find the peak. In this case I&#8217;m actually cheating by using a Normal Curve, since it always has a slope leading to the peak. A true needle in the haystack case would have flat ends, but this hill climber has no real way to find that case except by chance.</p>
</div>
<div class="section" id="using-gaussian-convolution">
<span id="optimization-optimizers-steepestascent-gaussianconvolution"></span><h2>Using Gaussian Convolution<a class="headerlink" href="#using-gaussian-convolution" title="Permalink to this headline">¶</a></h2>
<p>The UniformConvolution used as the tweak tends to get stuck in local optima. You can make the half-range larger but then it will have a harder time finding an optima as it approaches randomness. One way to improve the hill-climbers is to sample random values from a normal distribution. Since 68% of the points are within one standard deviation from the mean, 95% are within two standard deviations from the mean, 99% are within three standard deviations, etc., you will tend to get most sampled points centered around the mean (0 for the standard-normal distribution) and only occasionally will you get samples that are far from the mean.</p>
<p>As a comparison, I&#8217;ll first use a data-set that has local optima. Using the UniformConvolution doesn&#8217;t always find the solution (because it&#8217;s stuck at a local optima) so I&#8217;m only going to run the gaussian convolution version.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># change the randomization</span>
<span class="n">tweak</span> <span class="o">=</span> <span class="n">GaussianConvolution</span><span class="p">(</span><span class="n">lower_bound</span><span class="o">=</span><span class="n">simulator</span><span class="o">.</span><span class="n">domain_start</span><span class="p">,</span>
                            <span class="n">upper_bound</span><span class="o">=</span><span class="n">simulator</span><span class="o">.</span><span class="n">domain_end</span><span class="p">)</span>
<span class="n">tweaker</span> <span class="o">=</span> <span class="n">XYTweak</span><span class="p">(</span><span class="n">tweak</span><span class="p">)</span>
<span class="n">climber</span><span class="o">.</span><span class="n">_solutions</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">climber</span><span class="o">.</span><span class="n">tweak</span> <span class="o">=</span> <span class="n">tweaker</span>

<span class="c1"># change the dataset</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">functions</span> <span class="o">=</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
                       <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">]</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">_range</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">quality_checks</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">candidate</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">simulator</span><span class="p">(</span><span class="n">candidate</span><span class="p">)</span>
<span class="n">climber</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="n">candidate</span>
<span class="n">stop</span><span class="o">.</span><span class="n">ideal_value</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">ideal_solution</span>
<span class="n">stop</span><span class="o">.</span><span class="n">_end_time</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># run the optimization</span>
<span class="n">outcomes</span><span class="p">[</span><span class="s1">&#39;Gaussian Noise&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run_climber</span><span class="p">(</span><span class="n">climber</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Solution</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">:</span> <span class="p">[</span> <span class="mf">0.43583544</span><span class="p">]</span> <span class="n">Output</span><span class="p">:</span> <span class="mf">1.60675092559</span>
<span class="n">Ideal</span><span class="p">:</span> <span class="mf">1.60675092559</span>
<span class="n">Difference</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="n">Elapsed</span><span class="p">:</span> <span class="mf">0.33668088913</span>
<span class="n">Quality</span> <span class="n">Checks</span><span class="p">:</span> <span class="mi">13340</span>
<span class="n">Comparisons</span><span class="p">:</span> <span class="mf">6669.5</span>
<span class="n">Solutions</span><span class="p">:</span> <span class="mi">8</span>
<span class="n">Solutions</span><span class="o">/</span><span class="n">Comparisons</span><span class="p">:</span> <span class="mf">0.00119949021666</span>
</pre></div>
</div>
<div class="figure">
<img src="../../_images/gaussian_convolution_steepest_ascent_solutions.svg" /></div>
<div class="figure">
<img src="../../_images/gaussian_convolution_steepest_ascent_dataplot.svg" /></div>
</div>
<div class="section" id="gaussian-convolution-normal-example">
<span id="optimization-optimizers-steepestascent-gaussianconvolution-normal"></span><h2>Gaussian Convolution Normal Example<a class="headerlink" href="#gaussian-convolution-normal-example" title="Permalink to this headline">¶</a></h2>
<p>To see how the two algorithms compare we can re-run the normal example using the GaussianConvolution.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">simulator</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">domain_start</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">domain_end</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">candidate</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">climber</span><span class="o">.</span><span class="n">_solutions</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">climber</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="n">candidate</span>
<span class="n">stop</span><span class="o">.</span><span class="n">_end_time</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">stop</span><span class="o">.</span><span class="n">ideal_value</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">ideal_solution</span>
<span class="n">outcomes</span><span class="p">[</span><span class="s1">&#39;Gaussian Normal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run_climber</span><span class="p">(</span><span class="n">climber</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Solution</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">:</span> <span class="p">[</span> <span class="mf">0.00265114</span><span class="p">]</span> <span class="n">Output</span><span class="p">:</span> <span class="mf">0.398939082483</span>
<span class="n">Ideal</span><span class="p">:</span> <span class="mf">0.398939082483</span>
<span class="n">Difference</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="n">Elapsed</span><span class="p">:</span> <span class="mf">0.00111103057861</span>
<span class="n">Quality</span> <span class="n">Checks</span><span class="p">:</span> <span class="mi">73</span>
<span class="n">Comparisons</span><span class="p">:</span> <span class="mf">36.0</span>
<span class="n">Solutions</span><span class="p">:</span> <span class="mi">4</span>
<span class="n">Solutions</span><span class="o">/</span><span class="n">Comparisons</span><span class="p">:</span> <span class="mf">0.111111111111</span>
</pre></div>
</div>
<div class="figure">
<img src="../../_images/steepest_ascent_gaussian_convolution_normal_solutions.svg" /></div>
<div class="figure">
<img src="../../_images/steepest_ascent_gaussian_convolution_normal_dataset.svg" /></div>
</div>
<div class="section" id="gaussian-convolution-needle-example">
<span id="optimization-optimizers-steepestascent-gaussianconvolution-needle"></span><h2>Gaussian Convolution Needle Example<a class="headerlink" href="#gaussian-convolution-needle-example" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">simulator</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">domain_start</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">domain_end</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">candidate</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">climber</span><span class="o">.</span><span class="n">_solutions</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">climber</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="n">candidate</span>
<span class="n">stop</span><span class="o">.</span><span class="n">_end_time</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">stop</span><span class="o">.</span><span class="n">ideal_value</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">ideal_solution</span>
<span class="n">outcomes</span><span class="p">[</span><span class="s1">&#39;Gaussian Needle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run_climber</span><span class="p">(</span><span class="n">climber</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Solution</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.03550444</span><span class="p">]</span> <span class="n">Output</span><span class="p">:</span> <span class="mf">0.398623190415</span>
<span class="n">Ideal</span><span class="p">:</span> <span class="mf">0.398922329796</span>
<span class="n">Difference</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.000299139380939</span>
<span class="n">Elapsed</span><span class="p">:</span> <span class="mf">0.00325894355774</span>
<span class="n">Quality</span> <span class="n">Checks</span><span class="p">:</span> <span class="mi">127</span>
<span class="n">Comparisons</span><span class="p">:</span> <span class="mf">63.0</span>
<span class="n">Solutions</span><span class="p">:</span> <span class="mi">4</span>
<span class="n">Solutions</span><span class="o">/</span><span class="n">Comparisons</span><span class="p">:</span> <span class="mf">0.0634920634921</span>
</pre></div>
</div>
<div class="figure">
<img src="../../_images/steepest_ascent_gaussian_convolution_needle_solutions.svg" /></div>
<div class="figure">
<img src="../../_images/steepest_ascent_gaussian_convolution_needle_dataset.svg" /></div>
</div>
<div class="section" id="gaussian-convolution-sphere">
<span id="optimization-optimizers-steepestascent-gaussianconvolution-sphere"></span><h2>Gaussian Convolution Sphere<a class="headerlink" href="#gaussian-convolution-sphere" title="Permalink to this headline">¶</a></h2>
<p>This uses a 3-d spherical dataset.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">optimization.datamappings.examples.functions</span> <span class="k">import</span> <span class="n">SphereMapping</span>
<span class="c1"># for plotting only we want few steps</span>
<span class="n">plot_sphere</span> <span class="o">=</span> <span class="n">SphereMapping</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>

<span class="c1"># for data we want more</span>
<span class="n">data_sphere</span> <span class="o">=</span> <span class="n">SphereMapping</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;figures/sphere_plot.svg&#39;</span>
<span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">axe</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">5.12</span><span class="p">,</span> <span class="mf">5.12</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">5.12</span><span class="p">,</span> <span class="mf">5.12</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span>
<span class="n">surface</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">plot_wireframe</span><span class="p">(</span><span class="n">X</span><span class="p">,</span>
                             <span class="n">Y</span><span class="p">,</span>
                             <span class="n">Z</span><span class="p">,</span>
                             <span class="n">rstride</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">figure</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># change the data source to the sphere mapping</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">data_sphere</span><span class="o">.</span><span class="n">mapping</span>
<span class="n">climber</span><span class="o">.</span><span class="n">quality</span> <span class="o">=</span> <span class="n">simulator</span>

<span class="c1"># change the limits of the tweak</span>
<span class="n">tweak</span><span class="o">.</span><span class="n">lower_bound</span> <span class="o">=</span> <span class="n">data_sphere</span><span class="o">.</span><span class="n">start</span>
<span class="n">tweak</span><span class="o">.</span><span class="n">upper_bound</span> <span class="o">=</span> <span class="n">data_sphere</span><span class="o">.</span><span class="n">stop</span>

<span class="c1"># change the candidate to 2D</span>
<span class="n">candidate</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">candidate</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">climber</span><span class="o">.</span><span class="n">_solutions</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">climber</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="n">candidate</span>
<span class="n">stop</span><span class="o">.</span><span class="n">_end_time</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">stop</span><span class="o">.</span><span class="n">ideal_value</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">ideal</span>
<span class="n">outcomes</span><span class="p">[</span><span class="s1">&#39;Gaussian Sphere&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run_climber</span><span class="p">(</span><span class="n">climber</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Solution</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">:</span> <span class="p">[</span> <span class="mf">5.12</span> <span class="o">-</span><span class="mf">5.12</span><span class="p">]</span> <span class="n">Output</span><span class="p">:</span> <span class="mf">52.4288</span>
<span class="n">Ideal</span><span class="p">:</span> <span class="mf">52.4288</span>
<span class="n">Difference</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="n">Elapsed</span><span class="p">:</span> <span class="mf">0.00174617767334</span>
<span class="n">Quality</span> <span class="n">Checks</span><span class="p">:</span> <span class="mi">109</span>
<span class="n">Comparisons</span><span class="p">:</span> <span class="mf">54.0</span>
<span class="n">Solutions</span><span class="p">:</span> <span class="mi">6</span>
<span class="n">Solutions</span><span class="o">/</span><span class="n">Comparisons</span><span class="p">:</span> <span class="mf">0.111111111111</span>
</pre></div>
</div>
<div class="figure">
<img src="../../_images/sphere_plot.svg" /></div>
<table border="1" class="docutils" id="id1">
<caption><span class="caption-text">Run-Time Comparisons</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&nbsp;</th>
<th class="head">Solutions</th>
<th class="head">Comparisons</th>
<th class="head">Solutions/Comparisons</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Uniform Normal</td>
<td>58.000</td>
<td>300.000</td>
<td>0.193</td>
</tr>
<tr class="row-odd"><td>Uniform Needle</td>
<td>7.000</td>
<td>63.000</td>
<td>0.111</td>
</tr>
<tr class="row-even"><td>Gaussian Noise</td>
<td>8.000</td>
<td>6669.500</td>
<td>0.001</td>
</tr>
<tr class="row-odd"><td>Gaussian Normal</td>
<td>4.000</td>
<td>36.000</td>
<td>0.111</td>
</tr>
<tr class="row-even"><td>Gaussian Needle</td>
<td>4.000</td>
<td>63.000</td>
<td>0.063</td>
</tr>
<tr class="row-odd"><td>Gaussian Sphere</td>
<td>6.000</td>
<td>54.000</td>
<td>0.111</td>
</tr>
</tbody>
</table>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014, russell nakamura.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>